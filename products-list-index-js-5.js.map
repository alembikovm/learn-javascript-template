{"version":3,"sources":["webpack:///./src/components/sortable-table/index.js","webpack:///./src/components/double-slider/index.js","webpack:///./src/components/sort-panel/index.js","webpack:///./src/pages/products/list/products-header.js","webpack:///./src/pages/products/list/index.js","webpack:///./src/utils/fetch-json.js"],"names":["SortableTable","constructor","headersConfig","url","sorted","id","find","item","sortable","order","isSortLocally","step","start","end","this","async","bottom","element","getBoundingClientRect","document","documentElement","clientHeight","loading","data","loadData","update","event","column","target","closest","dataset","newOrder","asc","desc","toggleOrder","append","subElements","arrow","sortLocally","sortOnServer","URL","render","wrapper","createElement","innerHTML","getTable","firstElementChild","getSubElements","renderRows","initEventListeners","searchParams","set","classList","add","fetchJson","remove","addRows","body","getTableRows","rows","childNodes","getTableHeader","map","getHeaderRow","join","title","getHeaderSortingArrow","getTableBody","getTableRow","template","header","addEventListener","onSortClick","onWindowScroll","sortedData","sortData","length","arr","sortType","customSorting","direction","sort","a","b","localeCompare","querySelectorAll","reduce","accum","subElement","removeEventListener","destroy","DoubleSlider","min","max","formatValue","value","selected","from","to","preventDefault","thumbLeft","thumbRight","inner","progress","left","innerLeft","right","innerRight","width","dragging","newLeft","clientX","shiftX","parseFloat","style","getValue","newRight","onThumbPointerMove","onThumbPointerUp","dispatchEvent","CustomEvent","detail","bubbles","originalMin","originalMax","ondragstart","onThumbPointerDown","rangeTotal","Math","floor","reset","thumbElem","round","SortPanel","sliderMin","sliderMax","initComponents","doubleSlider","components","renderComponents","Object","keys","forEach","component","root","$element","values","category","Page","sliderOriginalFrom","sliderOriginalTo","type","sliderFrom","sliderTo","sortableTable","sortableTableElem","sortPanel","filterName","filterStatus","filterNameValue","filterStatusValue","process","filtered","filterProducts","Date","getTime","modifyEmptyPlaceholder","resetFiltersButton","querySelector","resetFilters","removeEventListeners","emptyPlaceholder","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","status","Error","super","window","reason","alert"],"mappings":"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","file":"products-list-index-js-5.js","sourcesContent":["import fetchJson from \"../../utils/fetch-json.js\";\r\n\r\nconst BACKEND_URL = 'https://course-js.javascript.ru';\r\n\r\nexport default class SortableTable {\r\n  element;\r\n  subElements = {};\r\n  data = [];\r\n  loading = false;\r\n  step = 20;\r\n  start = 1;\r\n  end = this.start + this.step;\r\n\r\n  onWindowScroll = async() => {\r\n    const { bottom } = this.element.getBoundingClientRect();\r\n    const { id, order } = this.sorted;\r\n\r\n    if (bottom < document.documentElement.clientHeight && !this.loading && !this.isSortLocally) {\r\n      this.start = this.end;\r\n      this.end = this.start + this.step;\r\n\r\n      this.loading = true;\r\n\r\n      const data = await this.loadData(id, order, this.start, this.end);\r\n      this.update(data);\r\n\r\n      this.loading = false;\r\n    }\r\n  };\r\n\r\n  onSortClick = event => {\r\n    const column = event.target.closest('[data-sortable=\"true\"]');\r\n    const toggleOrder = order => {\r\n      const orders = {\r\n        asc: 'desc',\r\n        desc: 'asc'\r\n      };\r\n\r\n      return orders[order];\r\n    };\r\n\r\n    if (column) {\r\n      const { id, order } = column.dataset;\r\n      const newOrder = toggleOrder(order);\r\n\r\n      this.sorted = {\r\n        id,\r\n        order: newOrder\r\n      };\r\n\r\n      column.dataset.order = newOrder;\r\n      column.append(this.subElements.arrow);\r\n\r\n      if (this.isSortLocally) {\r\n        this.sortLocally(id, newOrder);\r\n      } else {\r\n        this.sortOnServer(id, newOrder);\r\n      }\r\n    }\r\n  };\r\n\r\n  constructor(headersConfig = [], {\r\n    url = '',\r\n    sorted = {\r\n      id: headersConfig.find(item => item.sortable).id,\r\n      order: 'asc'\r\n    },\r\n    isSortLocally = false,\r\n    step = 20,\r\n    start = 1,\r\n    end = start + step\r\n  } = {}) {\r\n\r\n    this.headersConfig = headersConfig;\r\n    this.url = new URL(url, BACKEND_URL);\r\n    this.sorted = sorted;\r\n    this.isSortLocally = isSortLocally;\r\n    this.step = step;\r\n    this.start = start;\r\n    this.end = end;\r\n\r\n    this.render();\r\n  }\r\n\r\n  async render() {\r\n    const {id, order} = this.sorted;\r\n    const wrapper = document.createElement('div');\r\n\r\n    wrapper.innerHTML = this.getTable();\r\n\r\n    const element = wrapper.firstElementChild;\r\n\r\n    this.element = element;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n    this.renderRows(data);\r\n    this.initEventListeners();\r\n  }\r\n\r\n  async loadData(id, order, start = this.start, end = this.end) {\r\n    this.url.searchParams.set('_sort', id);\r\n    this.url.searchParams.set('_order', order);\r\n    this.url.searchParams.set('_start', start);\r\n    this.url.searchParams.set('_end', end);\r\n\r\n    this.element.classList.add('sortable-table_loading');\r\n\r\n    const data = await fetchJson(this.url);\r\n\r\n    this.element.classList.remove('sortable-table_loading');\r\n\r\n    return data;\r\n  }\r\n\r\n  addRows(data) {\r\n    this.data = data;\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(data);\r\n  }\r\n\r\n  update(data) {\r\n    const rows = document.createElement('div');\r\n\r\n    this.data = [...this.data, ...data];\r\n    rows.innerHTML = this.getTableRows(data);\r\n\r\n    this.subElements.body.append(...rows.childNodes);\r\n  }\r\n\r\n  getTableHeader() {\r\n    return `<div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\r\n      ${this.headersConfig.map(item => this.getHeaderRow(item)).join('')}\r\n    </div>`;\r\n  }\r\n\r\n  getHeaderRow({id, title, sortable}) {\r\n    const order = this.sorted.id === id ? this.sorted.order : 'asc';\r\n\r\n    return `\r\n      <div class=\"sortable-table__cell\" data-id=\"${id}\" data-sortable=\"${sortable}\" data-order=\"${order}\">\r\n        <span>${title}</span>\r\n        ${this.getHeaderSortingArrow(id)}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getHeaderSortingArrow(id) {\r\n    const isOrderExist = this.sorted.id === id ? this.sorted.order : '';\r\n\r\n    return isOrderExist\r\n      ? `<span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\r\n          <span class=\"sort-arrow\"></span>\r\n        </span>`\r\n      : '';\r\n  }\r\n\r\n  getTableBody(data) {\r\n    return `\r\n      <div data-element=\"body\" class=\"sortable-table__body\">\r\n        ${this.getTableRows(data)}\r\n      </div>`;\r\n  }\r\n\r\n  getTableRows(data) {\r\n    return data.map(item => `\r\n      <div class=\"sortable-table__row\">\r\n        ${this.getTableRow(item, data)}\r\n      </div>`\r\n    ).join('');\r\n  }\r\n\r\n  getTableRow(item) {\r\n    const cells = this.headersConfig.map(({id, template}) => {\r\n      return {\r\n        id,\r\n        template\r\n      };\r\n    });\r\n\r\n    return cells.map(({id, template}) => {\r\n      return template\r\n        ? template(item[id])\r\n        : `<div class=\"sortable-table__cell\">${item[id]}</div>`;\r\n    }).join('');\r\n  }\r\n\r\n  getTable() {\r\n    return `\r\n      <div class=\"sortable-table\">\r\n        ${this.getTableHeader()}\r\n        ${this.getTableBody(this.data)}\r\n\r\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\r\n\r\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\r\n          No products\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.subElements.header.addEventListener('pointerdown', this.onSortClick);\r\n    document.addEventListener('scroll', this.onWindowScroll);\r\n  }\r\n\r\n  sortLocally(id, order) {\r\n    const sortedData = this.sortData(id, order);\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(sortedData);\r\n  }\r\n\r\n  async sortOnServer(id, order) {\r\n    const start = 1;\r\n    const end = start + this.step;\r\n    const data = await this.loadData(id, order, start, end);\r\n\r\n    this.renderRows(data);\r\n  }\r\n\r\n  renderRows(data) {\r\n    if (data.length) {\r\n      this.element.classList.remove('sortable-table_empty');\r\n      this.addRows(data);\r\n    } else {\r\n      this.element.classList.add('sortable-table_empty');\r\n    }\r\n  }\r\n\r\n  sortData(id, order) {\r\n    const arr = [...this.data];\r\n    const column = this.headersConfig.find(item => item.id === id);\r\n    const {sortType, customSorting} = column;\r\n    const direction = order === 'asc' ? 1 : -1;\r\n\r\n    return arr.sort((a, b) => {\r\n      switch (sortType) {\r\n        case 'number':\r\n          return direction * (a[id] - b[id]);\r\n        case 'string':\r\n          return direction * a[id].localeCompare(b[id], 'ru');\r\n        case 'custom':\r\n          return direction * customSorting(a, b);\r\n        default:\r\n          return direction * (a[id] - b[id]);\r\n      }\r\n    });\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n    document.removeEventListener('scroll', this.onWindowScroll);\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.subElements = {};\r\n  }\r\n}\r\n","export default class DoubleSlider {\n    element;\n    subElements = {};\n  \n    onThumbPointerMove = event => {\n      event.preventDefault();\n  \n      const MIN_PERCENTAGE = 0;\n      const MAX_PERCENTAGE = 100;\n      const { thumbLeft, thumbRight, inner, progress, from, to } = this.subElements;\n      const { left: innerLeft, right: innerRight, width } = inner.getBoundingClientRect();\n  \n      if (this.dragging === thumbLeft) {\n        let newLeft = (event.clientX - innerLeft + this.shiftX) / width;\n  \n        if (newLeft < MIN_PERCENTAGE) {\n          newLeft = MIN_PERCENTAGE;\n        }\n  \n        newLeft *= MAX_PERCENTAGE;\n  \n        const right = parseFloat(thumbRight.style.right);\n  \n        if (newLeft + right > MAX_PERCENTAGE) {\n          newLeft = MAX_PERCENTAGE - right;\n        }\n  \n        this.dragging.style.left = `${newLeft}%`;\n        progress.style.left = `${newLeft}%`;\n        from.innerHTML = this.formatValue(this.getValue().from);\n      } else {\n        let newRight = (innerRight - event.clientX - this.shiftX) / width;\n  \n        if (newRight < MIN_PERCENTAGE) {\n          newRight = MIN_PERCENTAGE;\n        }\n        newRight *= MAX_PERCENTAGE;\n  \n        let left = parseFloat(this.subElements.thumbLeft.style.left);\n  \n        if (left + newRight > MAX_PERCENTAGE) {\n          newRight = MAX_PERCENTAGE - left;\n        }\n        this.dragging.style.right = `${newRight}%`;\n        progress.style.right = `${newRight}%`;\n        to.innerHTML = this.formatValue(this.getValue().to);\n      }\n    };\n  \n    onThumbPointerUp = () => {\n      this.element.classList.remove('range-slider_dragging');\n  \n      document.removeEventListener('pointermove', this.onThumbPointerMove);\n      document.removeEventListener('pointerup', this.onThumbPointerUp);\n  \n      this.element.dispatchEvent(new CustomEvent('range-select', {\n        detail: this.getValue(),\n        bubbles: true\n      }));\n    };\n  \n    constructor({\n      min = 100,\n      max = 200,\n      formatValue = value => '$' + value,\n      selected = {\n        from: min,\n        to: max\n      }\n    } = {}) {\n      this.min = min;\n      this.max = max;\n      this.originalMin = this.min;\n      this.originalMax = this.max;\n      this.formatValue = formatValue;\n      this.selected = selected;\n  \n      this.render();\n    }\n  \n    get template() {\n      const { from, to } = this.selected;\n  \n      return `<div class=\"range-slider\">\n        <span data-element=\"from\">${this.formatValue(from)}</span>\n        <div data-element=\"inner\" class=\"range-slider__inner\">\n          <span data-element=\"progress\" class=\"range-slider__progress\"></span>\n          <span data-element=\"thumbLeft\" class=\"range-slider__thumb-left\"></span>\n          <span data-element=\"thumbRight\" class=\"range-slider__thumb-right\"></span>\n        </div>\n        <span data-element=\"to\">${this.formatValue(to)}</span>\n      </div>`;\n    }\n  \n    render() {\n      const element = document.createElement('div');\n  \n      element.innerHTML = this.template;\n  \n      this.element = element.firstElementChild;\n      this.element.ondragstart = () => false;\n  \n      this.subElements = this.getSubElements(element);\n  \n      this.initEventListeners();\n  \n      this.update();\n    }\n  \n    initEventListeners() {\n      const { thumbLeft, thumbRight } = this.subElements;\n  \n      thumbLeft.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\n      thumbRight.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\n    }\n  \n    getSubElements(element) {\n      const elements = element.querySelectorAll('[data-element]');\n  \n      return [...elements].reduce((accum, subElement) => {\n        accum[subElement.dataset.element] = subElement;\n  \n        return accum;\n      }, {});\n    }\n  \n    remove() {\n      this.element.remove();\n    }\n  \n    destroy() {\n      this.remove();\n      document.removeEventListener('pointermove', this.onThumbPointerMove);\n      document.removeEventListener('pointerup', this.onThumbPointerUp);\n    }\n  \n    update() {\n      const { progress, thumbLeft, thumbRight } = this.subElements;\n      const rangeTotal = this.max - this.min;\n      const left = Math.floor((this.selected.from - this.min) / rangeTotal * 100) + '%';\n      const right = Math.floor((this.max - this.selected.to) / rangeTotal * 100) + '%';\n  \n      progress.style.left = left;\n      progress.style.right = right;\n  \n      thumbLeft.style.left = left;\n      thumbRight.style.right = right;\n    }\n  \n    reset() {\n      const { from, to } = this.subElements;\n  \n      this.min = this.originalMin;\n      this.selected.from = this.originalMin;\n      from.innerHTML = this.formatValue(this.originalMin);\n  \n      this.max = this.originalMax;\n      this.selected.to = this.originalMax;\n      to.innerHTML = this.formatValue(this.originalMax);\n  \n      this.update();\n    }\n  \n    onThumbPointerDown(event) {\n      const thumbElem = event.target;\n  \n      event.preventDefault();\n  \n      const { left, right } = thumbElem.getBoundingClientRect();\n  \n      if (thumbElem === this.subElements.thumbLeft) {\n        this.shiftX = right - event.clientX;\n      } else {\n        this.shiftX = left - event.clientX;\n      }\n  \n      this.dragging = thumbElem;\n  \n      this.element.classList.add('range-slider_dragging');\n  \n      document.addEventListener('pointermove', this.onThumbPointerMove);\n      document.addEventListener('pointerup', this.onThumbPointerUp);\n    }\n  \n    getValue() {\n      const { thumbLeft, thumbRight } = this.subElements;\n      const rangeTotal = this.max - this.min;\n      const { left } = thumbLeft.style;\n      const { right } = thumbRight.style;\n  \n      const from = Math.round(this.min + parseFloat(left) * 0.01 * rangeTotal);\n      const to = Math.round(this.max - parseFloat(right) * 0.01 * rangeTotal);\n  \n      return { from, to };\n    }\n  }","import DoubleSlider from '../../components/double-slider/index.js';\n\nexport default class SortPanel {\n  element;\n  subElements = {};\n  components = {};\n\n  constructor({ sliderMin = 0, sliderMax = 4000 } = {}) {\n    this.sliderMin = sliderMin;\n    this.sliderMax = sliderMax;\n\n    this.render();\n  }\n\n  initComponents() {\n    const doubleSlider = new DoubleSlider({\n      min: this.sliderMin,\n      max: this.sliderMax\n    });\n\n    this.components.doubleSlider = doubleSlider;\n  }\n\n  get template() {\n    return `\n    <div class=\"content-box content-box_small\">\n      <form class=\"form-inline\">\n        <div class=\"form-group\">\n          <label class=\"form-label\">Сортировать по:</label>\n          <input type=\"text\" data-element=\"filterName\" class=\"form-control\" placeholder=\"Название товара\">\n        </div>\n      <div data-element=\"doubleSlider\">\n        <!-- double-slider component -->\n      </div>\n      <div class=\"form-group\">\n        <label class=\"form-label\">Статус:</label>\n        <select class=\"form-control\" data-element=\"filterStatus\">\n          <option value=\"\" selected=\"\">Любой</option>\n          <option value=\"1\">Активный</option>\n          <option value=\"0\">Неактивный</option>\n        </select>\n      </div>\n    </form>\n  </div>`;\n  }\n\n  render() {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    this.initComponents();\n\n    this.renderComponents();\n\n    return this.element;\n  }\n\n  renderComponents() {\n    Object.keys(this.components).forEach(component => {\n      const root = this.subElements[component];\n      const { element } = this.components[component];\n\n      root.append(element);\n    });\n  }\n\n  getSubElements($element) {\n    const elements = $element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  destroy() {\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n}\n","const header = [\n  {\n    id: 'images',\n    title: 'Image',\n    sortable: false,\n    template: data => {\n      return `\n            <div class=\"sortable-table__cell\">\n              <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0] ? data[0].url : ''}\">\n            </div>\n          `;\n    }\n  },\n  {\n    id: 'title',\n    title: 'Name',\n    sortable: true,\n    sortType: 'string'\n  },\n  {\n    id: 'subcategory',\n    title: 'Subcategory',\n    sortable: false,\n    template: data => {\n      return `\n          <div class=\"sortable-table__cell\">\n            ${\n              data.category && data.title\n                ? `<span data-tooltip=\n                \"\n                  <div class=&quot;sortable-table-tooltip&quot;>\n                    <span class=&quot;sortable-table-tooltip__category&quot;>${\n                      data.category ? data.category.title : ''\n                    }</span> /\n                    <b class=&quot;sortable-table-tooltip__subcategory&quot;>${data.title}</b>\n                  </div>\n                \">\n                  ${data.title}\n                </span> `\n                : '-'\n            }\n          </div>\n          `;\n    }\n  },\n  {\n    id: 'quantity',\n    title: 'Quantity',\n    sortable: true,\n    sortType: 'number'\n  },\n  {\n    id: 'price',\n    title: 'Price',\n    sortable: true,\n    sortType: 'number',\n    template: data => {\n      return `<div class=\"sortable-table__cell\">$${data}</div>`;\n    }\n  },\n  {\n    id: 'status',\n    title: 'Status',\n    sortable: true,\n    sortType: 'number',\n    template: data => {\n      return `<div class=\"sortable-table__cell\">\n            ${data > 0 ? 'Active' : 'Inactive'}\n          </div>`;\n    }\n  }\n];\n\nexport default header;\n","import SortableTable from '../../../components/sortable-table/index.js';\r\nimport SortPanel from '../../../components/sort-panel/index.js';\r\nimport header from './products-header.js';\r\nimport fetchJson from '../../../utils/fetch-json.js';\r\n\r\nconst BACKEND_URL = process.env.BACKEND_URL;\r\nconst PRODUCTS_URL = \"api/rest/products\";\r\n\r\nexport default class Page {\r\n  element;\r\n  subElements = {};\r\n  components = {};\r\n  sliderOriginalFrom = 0;\r\n  sliderOriginalTo = 4000;\r\n  sliderFrom = this.sliderOriginalFrom;\r\n  sliderTo = this.sliderOriginalTo;\r\n\r\n  filterProducts = async (event) => {\r\n    const { type, detail } = event;\r\n\r\n    if (type === \"range-select\") {\r\n      const { from, to } = detail;\r\n      this.sliderFrom = from;\r\n      this.sliderTo = to;\r\n    }\r\n    \r\n    // reset these values each time a filter is added or changed\r\n    // in order to load data with filter each time from the beginning\r\n    this.components.sortableTable.start = 1;\r\n    this.components.sortableTable.end = 1 + this.components.sortableTable.step;\r\n    \r\n    const { sorted, start, end, element: sortableTableElem } = this.components.sortableTable;\r\n    const { id, order } = sorted;\r\n    \r\n    sortableTableElem.classList.add(\"sortable-table_loading\");\r\n    \r\n    const { subElements } = this.components.sortPanel;\r\n    const { filterName, filterStatus } = subElements;\r\n    const { value: filterNameValue } = filterName;\r\n    const { value: filterStatusValue } = filterStatus;\r\n\r\n    const url = new URL(PRODUCTS_URL, BACKEND_URL);\r\n\r\n    url.searchParams.set(\"price_gte\", this.sliderFrom);\r\n    url.searchParams.set(\"price_lte\", this.sliderTo);\r\n\r\n    if (filterNameValue) {\r\n      url.searchParams.set(\"title_like\", filterNameValue);\r\n    }\r\n\r\n    if (filterStatusValue) {\r\n      url.searchParams.set(\"status\", filterStatusValue);\r\n    }\r\n\r\n    url.searchParams.set('_sort', id);\r\n    url.searchParams.set('_order', order);\r\n    url.searchParams.set('_start', start);\r\n    url.searchParams.set('_end', end);\r\n    \r\n    //preserve this for server side sorting and for onscroll loading\r\n    this.components.sortableTable.filtered = {\r\n      \"price_gte\": this.sliderFrom,\r\n      \"price_lte\": this.sliderTo,\r\n      \"title_like\": filterNameValue,\r\n      \"status\": filterStatusValue\r\n    }\r\n\r\n    const data = await fetchJson(url);\r\n    this.components.sortableTable.addRows(data);\r\n\r\n    sortableTableElem.classList.remove(\"sortable-table_loading\");\r\n  }\r\n\r\n  resetFilters = (event) => {\r\n    event.preventDefault();\r\n\r\n    const { subElements, components } = this.components.sortPanel;\r\n    const { filterName, filterStatus } = subElements;\r\n    const { doubleSlider } = components;\r\n\r\n    filterName.value = \"\";\r\n    filterStatus.value = \"\";\r\n    this.sliderFrom = this.sliderOriginalFrom;\r\n    this.sliderTo = this.sliderOriginalTo;\r\n    \r\n    doubleSlider.reset();\r\n\r\n    this.filterProducts(event);\r\n  }\r\n\r\n  async initComponents () {\r\n    const to = new Date();\r\n    const from = new Date(to.getTime() - (30 * 24 * 60 * 60 * 1000));\r\n\r\n    const sortPanel = new SortPanel({\r\n      sliderMin: this.sliderFrom,\r\n      sliderMax: this.sliderTo\r\n    });\r\n\r\n    const sortableTable = new SortableTable(header, {\r\n      url: `api/rest/products?_embed=subcategory.category&_sort=title&_order=asc&_start=0&_end=30`\r\n    });\r\n\r\n    this.components.sortPanel = sortPanel;\r\n    this.components.sortableTable = sortableTable;\r\n  }\r\n\r\n  get template () {\r\n    return `\r\n    <div class=\"products-list\">\r\n      <div class=\"content__top-panel\">\r\n        <h1 class=\"page-title\">Товары</h1>\r\n        <a href=\"/products/add\" class=\"button-primary\">Добавить товар</a>\r\n      </div>\r\n      <div data-element=\"sortPanel\">\r\n        <!-- sort-panel component -->\r\n      </div>\r\n      <div data-element=\"sortableTable\">\r\n        <!-- sortable-table component -->\r\n      </div>\r\n    </div>`;\r\n  }\r\n\r\n  async render () {\r\n    const element = document.createElement('div');\r\n\r\n    element.innerHTML = this.template;\r\n\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    await this.initComponents();\r\n\r\n    this.renderComponents();\r\n\r\n    this.modifyEmptyPlaceholder();\r\n\r\n    this.initEventListeners();\r\n\r\n    return this.element;\r\n  }\r\n\r\n  initEventListeners() {\r\n    const { subElements } = this.components.sortPanel;\r\n    const { filterName, filterStatus } = subElements;\r\n    const resetFiltersButton = this.element.querySelector(\".button-primary-outline\");\r\n\r\n    for (const element of [filterName, filterStatus]) {\r\n      element.addEventListener(\"input\", this.filterProducts);\r\n    }\r\n\r\n    resetFiltersButton.addEventListener(\"click\", this.resetFilters);\r\n\r\n    this.element.addEventListener(\"range-select\", this.filterProducts);\r\n  }\r\n\r\n  removeEventListeners() {\r\n    const { subElements } = this.components.sortPanel;\r\n    const { filterName, filterStatus } = subElements;\r\n    const resetFiltersButton = this.element.querySelector(\".button-primary-outline\");\r\n\r\n    for (const element of [filterName, filterStatus]) {\r\n      element.removeEventListener(\"input\", this.filterProducts);\r\n    }\r\n\r\n    resetFiltersButton.removeEventListener(\"click\", this.resetFilters);\r\n\r\n    this.element.removeEventListener(\"range-select\", this.filterProducts);\r\n  }\r\n\r\n  modifyEmptyPlaceholder() {\r\n    const { subElements } = this.components.sortableTable;\r\n    const { emptyPlaceholder } = subElements;\r\n    emptyPlaceholder.innerHTML = `\r\n      <div>\r\n        <p>Не найдено товаров удовлетворяющих выбранному критерию</p>\r\n        <button type=\"button\" class=\"button-primary-outline\">Очистить фильтры</button>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  renderComponents () {\r\n    Object.keys(this.components).forEach(component => {\r\n      const root = this.subElements[component];\r\n      const { element } = this.components[component];\r\n\r\n      root.append(element);\r\n    });\r\n  }\r\n\r\n  getSubElements ($element) {\r\n    const elements = $element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  destroy () {\r\n    this.removeEventListeners(); \r\n    for (const component of Object.values(this.components)) {\r\n      component.destroy();\r\n    }\r\n  }\r\n}","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\n\r\nexport default async function(url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch(err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\r\n    } catch (error) { /* ignore failed body */ }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch(err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener('unhandledrejection', event => {\r\n  if (event.reason instanceof FetchError) {\r\n    alert(event.reason.message);\r\n  }\r\n});\r\n\r\n"],"sourceRoot":""}